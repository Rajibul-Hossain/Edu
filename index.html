<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EduConnect — Student Feedback (Stars)</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="web.css">
  
</head>
<body>
  <div class="stage">
    <div class="card" role="main">
      <div class="shape s1"></div>
      <div class="shape s2"></div>

      <div class="header">
        <div class="logo">EC</div>
        <div class="meta">
          <div class="title">EduConnect — Student Feedback</div>
          <div class="subtitle">Honest, anonymous option available • Responses saved securely</div>
        </div>
      </div>

      <div class="main">
        <div class="left">

          <div class="q">
            <h3>1. Do teachers come on time for class?</h3>
            <div class="options" data-q="punctuality">
              <div class="opt" data-value="Always">Always</div>
              <div class="opt" data-value="Mostly">Mostly</div>
              <div class="opt" data-value="Sometimes">Sometimes</div>
              <div class="opt" data-value="Rarely">Rarely</div>
            </div>
            <div class="hint">Choose the option that best matches your experience.</div>
          </div>

          <div class="q">
            <h3>2. How clear are the teachers' explanations?</h3>
            <div class="options" data-q="clarity">
              <div class="opt" data-value="Very Clear">Very Clear</div>
              <div class="opt" data-value="Clear">Clear</div>
              <div class="opt" data-value="Sometimes Confusing">Sometimes Confusing</div>
              <div class="opt" data-value="Often Confusing">Often Confusing</div>
            </div>
          </div>

          <div class="q">
            <h3>3. Fairness in grading and attention?</h3>
            <div class="options" data-q="fairness">
              <div class="opt" data-value="Very Fair">Very Fair</div>
              <div class="opt" data-value="Mostly Fair">Mostly Fair</div>
              <div class="opt" data-value="Neutral">Neutral</div>
              <div class="opt" data-value="Unfair">Unfair</div>
            </div>
          </div>

          <div class="q">
            <h3>4. Classroom environment (discipline & support)?</h3>
            <div class="options" data-q="environment">
              <div class="opt" data-value="Excellent">Excellent</div>
              <div class="opt" data-value="Good">Good</div>
              <div class="opt" data-value="Average">Average</div>
              <div class="opt" data-value="Needs Improvement">Needs Improvement</div>
            </div>
          </div>
          
          <div class="q">
            <h3>5. Rate overall teaching quality</h3>
            <div class="stars-wrap">
              <div class="stars" role="radiogroup" aria-label="Overall rating">
                <button class="star-btn" data-value="1" aria-label="1 star" tabindex="0">
                  <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" stroke="currentColor" stroke-width="0" fill="currentColor"/></svg>
                  <span class="shine"></span>
                  <span class="spark"></span>
                  <span class="tooltip">Poor</span>
                </button>
                <button class="star-btn" data-value="2" aria-label="2 stars" tabindex="0">
                  <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" stroke="currentColor" stroke-width="0" fill="currentColor"/></svg>
                  <span class="shine"></span>
                  <span class="spark"></span>
                  <span class="tooltip">Below Avg</span>
                </button>
                <button class="star-btn" data-value="3" aria-label="3 stars" tabindex="0">
                  <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" stroke="currentColor" stroke-width="0" fill="currentColor"/></svg>
                  <span class="shine"></span>
                  <span class="spark"></span>
                  <span class="tooltip">Average</span>
                </button>
                <button class="star-btn" data-value="4" aria-label="4 stars" tabindex="0">
                  <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" stroke="currentColor" stroke-width="0" fill="currentColor"/></svg>
                  <span class="shine"></span>
                  <span class="spark"></span>
                  <span class="tooltip">Good</span>
                </button>
                <button class="star-btn" data-value="5" aria-label="5 stars" tabindex="0">
                  <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" stroke="currentColor" stroke-width="0" fill="currentColor"/></svg>
                  <span class="shine"></span>
                  <span class="spark"></span>
                  <span class="tooltip">Excellent</span>
                </button>
              </div>
              <div class="tiny">Tap a star • 1 (lowest) → 5 (highest)</div>
            </div>
          </div>

          <div class="q">
            <h3>6. Any suggestions or feedback?</h3>
            <textarea id="suggestions" rows="4" placeholder="Type constructive suggestions... (optional)" style="width:100%;padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:var(--accent)"></textarea>
          </div>

        </div>

        <aside class="right">
          <div class="panel">
            <h4>Student details</h4>
            <div class="field"><input type="text" id="studentName" placeholder="Full name" required></div>
            <div class="field"><input type="text" id="className" placeholder="Class (e.g. 9)" required></div>
            <div class="field"><input type="text" id="section" placeholder="Section (e.g. A)" required></div>

            <div class="divider"></div>

            <div class="field"><label class="tiny">Select Your Fav  Teacher (optional)</label>
              <select id="teacherSelect"><option value="">-- General --</option><option>Math</option><option>Science</option><option>English</option><option>Social Science</option><option>Hindi</option><option>Others</option></select></div>

            <div class="submit-row">
              <button class="btn primary" id="submitBtn">Submit Feedback</button>
              <button class="btn ghost" id="resetBtn">Reset</button>
            </div>
            <div class="spacer2"></div>
            <div class="note tiny">By submitting you allow admins to review this feedback. Sensitive info will be handled confidentially.</div>
          </div>
        </aside>

      </div>

    </div>
  </div>

  <div class="toast" id="toast">Saved — thanks for your feedback!</div>
  <footer class="tag">ARMY PUBLIC SCHOOL KOLKATA</footer>

  <script type="module">
    // Firebase modular imports (v10+)
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js';
    import { getFirestore, collection, addDoc, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore.js';

    // ---------- EDIT: paste your config ----------
const firebaseConfig = {
  apiKey: "AIzaSyDualJqcVE_-FH2AxVoxs5I-gTredNzFGA",
  authDomain: "aps-kolkata-5e7d3.firebaseapp.com",
  projectId: "aps-kolkata-5e7d3",
  storageBucket: "aps-kolkata-5e7d3.firebasestorage.app",
  messagingSenderId: "796966232821",
  appId: "1:796966232821:web:9ef72d827671ee8e7f5bbc",
  measurementId: "G-6RQJ92QX1H"
};
    // ---------------------------------------------

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // State
    const responses = {};
    const opts = {};

    // Options selection
    document.querySelectorAll('.options').forEach(container => {
      container.addEventListener('click', (e) => {
        const btn = e.target.closest('.opt');
        if(!btn) return;
        container.querySelectorAll('.opt').forEach(b=>b.classList.remove('selected'));
        btn.classList.add('selected');
        opts[container.dataset.q] = btn.dataset.value;
      });
    });

    // Stars logic
    const starButtons = Array.from(document.querySelectorAll('.star-btn'));
    let currentRating = 0;

    function setRating(r){
      currentRating = r;
      starButtons.forEach(btn=>{
        const v = Number(btn.dataset.value);
        if(v<=r){ btn.classList.add('filled'); } else { btn.classList.remove('filled'); }
      });
    }

    // Click & keyboard
    starButtons.forEach(btn => {
      btn.addEventListener('click', ()=>{
        const v = Number(btn.dataset.value);
        setRating(v);
        // tiny pop animation
        btn.animate([{transform:'scale(1.05)'},{transform:'scale(1)'}],{duration:260,easing:'cubic-bezier(.2,.9,.2,1)'});
      });
      btn.addEventListener('keydown', (e)=>{
        if(e.key === 'Enter' || e.key === ' '){ e.preventDefault(); btn.click(); }
        if(e.key === 'ArrowRight'){
          const next = Math.min(5, Number(btn.dataset.value)+1); setRating(next);
        }
        if(e.key === 'ArrowLeft'){
          const prev = Math.max(1, Number(btn.dataset.value)-1); setRating(prev);
        }
      });
      // hover preview
      btn.addEventListener('mouseover', ()=>{
        const v = Number(btn.dataset.value);
        starButtons.forEach(b=>{ if(Number(b.dataset.value) <= v) b.classList.add('filled'); });
      });
      btn.addEventListener('mouseout', ()=>{ setRating(currentRating); });
    });

    // Submit handler
    const submitBtn = document.getElementById('submitBtn');
    const resetBtn = document.getElementById('resetBtn');
    const toast = document.getElementById('toast');

    function showToast(msg){ toast.textContent = msg; toast.style.display='block'; setTimeout(()=>toast.style.display='none',2800); }

    submitBtn.addEventListener('click', async ()=>{
      submitBtn.disabled = true; submitBtn.textContent = 'Saving...';
      try{
        const payload = {
          name: document.getElementById('studentName').value.trim(),
          className: document.getElementById('className').value.trim(),
          section: document.getElementById('section').value.trim(),
          teacher: document.getElementById('teacherSelect').value || null,
          punctuality: opts.punctuality || null,
          clarity: opts.clarity || null,
          fairness: opts.fairness || null,
          environment: opts.environment || null,
          rating: currentRating || null,
          suggestions: document.getElementById('suggestions').value.trim() || null,
          createdAt: serverTimestamp()
        };

        // validation (basic)
        if(!payload.name || !payload.className || !payload.section){ showToast('Please fill name, class, section'); submitBtn.disabled=false; submitBtn.textContent='Submit Feedback'; return; }

        await addDoc(collection(db, 'feedback'), payload);
        showToast('Saved — thanks for your feedback!');
        // micro-success animation
        document.querySelector('.card').animate([{transform:'scale(1)'},{transform:'scale(1.01)'},{transform:'scale(1)'}],{duration:600, easing:'ease-out'});
        // reset
        document.getElementById('studentName').value=''; document.getElementById('className').value=''; document.getElementById('section').value=''; document.getElementById('teacherSelect').value=''; document.getElementById('suggestions').value='';
        document.querySelectorAll('.opt').forEach(b=>b.classList.remove('selected')); setRating(0); Object.keys(opts).forEach(k=>delete opts[k]);
      }catch(err){ console.error(err); showToast('Failed to save — check console'); }
      finally{ submitBtn.disabled=false; submitBtn.textContent='Submit Feedback'; }
    });

    resetBtn.addEventListener('click', ()=>{
      document.getElementById('feedbackForm')?.reset(); document.querySelectorAll('.opt').forEach(b=>b.classList.remove('selected')); setRating(0); Object.keys(opts).forEach(k=>delete opts[k]); showToast('Form reset');
    });

    // accessibility: allow pressing Enter on any input to submit
    document.getElementById('studentName').addEventListener('keydown',(e)=>{ if(e.key==='Enter'){ submitBtn.click(); } });

  </script>
</body>
</html>
